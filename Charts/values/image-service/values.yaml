# Image Service - Python
appName: image-service
namespace: image
environment: production

image:
  repository: 123456789012.dkr.ecr.us-east-1.amazonaws.com/image-service
  tag: v1.0.0
  pullPolicy: IfNotPresent

replicaCount: 3

service:
  port: 8080
  type: ClusterIP

resources:
  requests:
    cpu: "300m"
    memory: "512Mi"
  limits:
    cpu: "2000m"
    memory: "1Gi"

livenessProbe:
  path: /health
  initialDelaySeconds: 60
  periodSeconds: 15
  timeoutSeconds: 10
  failureThreshold: 3

readinessProbe:
  path: /ready
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

autoscaling:
  enabled: true
  minReplicas: 3
  maxReplicas: 15
  targetCPU: 60
  targetMemory: 75
  targetRPS: 50

pdb:
  minAvailable: 2

networkPolicy:
  allowedIngress:
    - namespace: api
  s3Endpoint: "10.0.3.0/24"

externalSecret:
  enabled: true
  refreshInterval: 5m
  secrets:
    - name: AWS_ACCESS_KEY_ID
      secretPath: prod/image-service/aws
      property: access_key
    - name: AWS_SECRET_ACCESS_KEY
      secretPath: prod/image-service/aws
      property: secret_key
    - name: S3_BUCKET
      secretPath: prod/image-service/s3
    - name: IMAGE_QUALITY
      secretPath: prod/image-service/config
      property: quality

aws:
  region: us-east-1

serviceAccount:
  roleArn: arn:aws:iam::123456789012:role/image-service-role

ingress:
  enabled: false

env:
  PYTHON_ENV: production
  LOG_LEVEL: info
  MAX_IMAGE_SIZE: "10485760"
  ALLOWED_EXTENSIONS: "jpg,jpeg,png,gif,webp"
  S3_REGION: us-east-1